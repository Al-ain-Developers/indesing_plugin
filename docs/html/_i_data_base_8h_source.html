<html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/xhtml;charset=UTF-8" http-equiv="Content-Type" /><meta content="IE=9" http-equiv="X-UA-Compatible" /><meta content="Doxygen 1.8.3.1" name="generator" /><title>_i_data_base_8h_source</title><link href="tabs.css" rel="stylesheet" type="text/css" /><script src="jquery.js" type="text/javascript"></script><script src="dynsections.js" type="text/javascript"></script><link href="navtree.css" rel="stylesheet" type="text/css" /><script src="resize.js" type="text/javascript"></script><script src="navtree.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(initResizable);

  $(window).load(resizeHeight);

</script><link href="search/search.css" rel="stylesheet" type="text/css" /><script src="search/search.js" type="text/javascript"></script><script type="text/javascript">

  $(document).ready(function() { searchBox.OnSelectItem(0); });

</script><link href="doxygen.css" rel="stylesheet" type="text/css" /></head><body><div id="top"><div id="titlearea"><table cellpadding="0" cellspacing="0"><tbody><tr style="height: 56px;"><td id="projectlogo"><img alt="Logo" src="adobe_logo.png" /></td><td style="padding-left: 0.5em;"><div id="projectname">InDesign SDK &nbsp;<span id="projectnumber">16.0.1</span></div></td></tr></tbody></table></div><script type="text/javascript">

var searchBox = new SearchBox("searchBox", "search",false,'Search');

</script><div class="tabs" id="navrow1"><ul class="tablist"><li><a href="index.html"><span>InDesign&nbsp;SDK</span></a><li><a href="pages.html"><span>Documentation</span></a><li><a href="group__bosses__parent.html"><span>Bosses</span></a><li><a href="group__sdk.html"><span>Sample&nbsp;plug-ins</span></a><li><a href="classes.html"><span>Class&nbsp;Index</span></a><li><div class="MSearchBoxInactive" id="MSearchBox"><span class="left"> <img alt="" id="MSearchSelect" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()" src="search/mag_sel.png" /> <input accesskey="S" id="MSearchField" onblur="searchBox.OnSearchFieldFocus(false)" onfocus="searchBox.OnSearchFieldFocus(true)" onkeyup="searchBox.OnSearchFieldChange(event)" type="text" value="Search" /> </span><span class="right"> <a href="javascript:searchBox.CloseResultsWindow()" id="MSearchClose"><img alt="" border="0" id="MSearchCloseImg" src="search/close.png" /></a> </span></div></ul></div></div><div class="ui-resizable side-nav-resizable" id="side-nav"><div id="nav-tree"><div id="nav-tree-contents"><div class="sync" id="nav-sync"></div></div></div><div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;"></div></div><script type="text/javascript">

$(document).ready(function(){initNavTree('_i_data_base_8h_source.html','');});

</script><div id="doc-content"><div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()"><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&nbsp;</span>Pages</a></div><div id="MSearchResultsWindow"><iframe frameborder="0" id="MSearchResults" name="MSearchResults" src="javascript:void(0)"></iframe></div><div class="header"><div class="headertitle"><div class="title">IDataBase.h</div></div></div><div class="contents"><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"> 1</span>&nbsp;<span class="comment">//========================================================================================</span></div><div class="line"><a name="l00002"></a><span class="lineno"> 2</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00003"></a><span class="lineno"> 3</span>&nbsp;<span class="comment">// $File: //depot/release/indesign_16/0.x/source/public/interfaces/architecture/IDataBase.h $</span></div><div class="line"><a name="l00004"></a><span class="lineno"> 4</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00005"></a><span class="lineno"> 5</span>&nbsp;<span class="comment">// Owner: Roey Horns </span></div><div class="line"><a name="l00006"></a><span class="lineno"> 6</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00007"></a><span class="lineno"> 7</span>&nbsp;<span class="comment">// $Author: nejindal $</span></div><div class="line"><a name="l00008"></a><span class="lineno"> 8</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00009"></a><span class="lineno"> 9</span>&nbsp;<span class="comment">// $DateTime: 2020/10/16 06:06:39 $</span></div><div class="line"><a name="l00010"></a><span class="lineno"> 10</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00011"></a><span class="lineno"> 11</span>&nbsp;<span class="comment">// $Revision: #1 $</span></div><div class="line"><a name="l00012"></a><span class="lineno"> 12</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00013"></a><span class="lineno"> 13</span>&nbsp;<span class="comment">// $Change: 1087558 $</span></div><div class="line"><a name="l00014"></a><span class="lineno"> 14</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00015"></a><span class="lineno"> 15</span>&nbsp;<span class="comment">// Copyright 1997-2010 Adobe Systems Incorporated. All rights reserved.</span></div><div class="line"><a name="l00016"></a><span class="lineno"> 16</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00017"></a><span class="lineno"> 17</span>&nbsp;<span class="comment">// NOTICE: Adobe permits you to use, modify, and distribute this file in accordance </span></div><div class="line"><a name="l00018"></a><span class="lineno"> 18</span>&nbsp;<span class="comment">// with the terms of the Adobe license agreement accompanying it. If you have received</span></div><div class="line"><a name="l00019"></a><span class="lineno"> 19</span>&nbsp;<span class="comment">// this file from a source other than Adobe, then your use, modification, or </span></div><div class="line"><a name="l00020"></a><span class="lineno"> 20</span>&nbsp;<span class="comment">// distribution of it requires the prior written permission of Adobe.</span></div><div class="line"><a name="l00021"></a><span class="lineno"> 21</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00022"></a><span class="lineno"> 22</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00023"></a><span class="lineno"> 23</span>&nbsp;<span class="comment">// Reviewed: 10/5/98</span></div><div class="line"><a name="l00024"></a><span class="lineno"> 24</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00025"></a><span class="lineno"> 25</span>&nbsp;<span class="comment">// Purpose: Provides access to the database that holds a K2 publication.</span></div><div class="line"><a name="l00026"></a><span class="lineno"> 26</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00027"></a><span class="lineno"> 27</span>&nbsp;<span class="comment">// THIS IS NOT A STANDARD BOSS INTERFACE</span></div><div class="line"><a name="l00028"></a><span class="lineno"> 28</span>&nbsp;<span class="comment">// </span></div><div class="line"><a name="l00029"></a><span class="lineno"> 29</span>&nbsp;<span class="comment">//========================================================================================</span></div><div class="line"><a name="l00030"></a><span class="lineno"> 30</span>&nbsp;</div><div class="line"><a name="l00031"></a><span class="lineno"> 31</span>&nbsp;<span class="preprocessor">#ifndef __IDATABASE__</span></div><div class="line"><a name="l00032"></a><span class="lineno"> 32</span>&nbsp;<span class="preprocessor"></span><span class="preprocessor">#define __IDATABASE__</span></div><div class="line"><a name="l00033"></a><span class="lineno"> 33</span>&nbsp;<span class="preprocessor"></span></div><div class="line"><a name="l00034"></a><span class="lineno"> 34</span>&nbsp;<span class="preprocessor">#include &quot;IPMUnknown.h&quot;</span> <span class="comment">// for the definition of </span></div><div class="line"><a name="l00035"></a><span class="lineno"> 35</span>&nbsp;<span class="preprocessor">#include &quot;GlobalTime.h&quot;</span> <span class="comment">// should be removed, but is indirectly included by many files</span></div><div class="line"><a name="l00036"></a><span class="lineno"> 36</span>&nbsp;<span class="preprocessor">#include &quot;IDFile.h&quot;</span> <span class="comment">// for IDFile</span></div><div class="line"><a name="l00037"></a><span class="lineno"> 37</span>&nbsp;<span class="preprocessor">#include &quot;IDatabaseSnapshot.h&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno"> 38</span>&nbsp;</div><div class="line"><a name="l00039"></a><span class="lineno"> 39</span>&nbsp;<span class="keyword">class </span><a class="code" href="class_i_d_time.html">IDTime</a>;</div><div class="line"><a name="l00040"></a><span class="lineno"> 40</span>&nbsp;<span class="keyword">class </span><a class="code" href="class_i_p_m_unknown.html">IPMUnknown</a>;</div><div class="line"><a name="l00041"></a><span class="lineno"> 41</span>&nbsp;<span class="keyword">class </span>IPubFile;</div><div class="line"><a name="l00042"></a><span class="lineno"> 42</span>&nbsp;<span class="keyword">class </span><a class="code" href="class_i_p_m_persist.html">IPMPersist</a>;</div><div class="line"><a name="l00043"></a><span class="lineno"> 43</span>&nbsp;<span class="keyword">class </span><a class="code" href="class_i_database_observer.html">IDatabaseObserver</a>;</div><div class="line"><a name="l00044"></a><span class="lineno"> 44</span>&nbsp;<span class="keyword">class </span><a class="code" href="class_i_u_i_d_iterator.html">IUIDIterator</a>;</div><div class="line"><a name="l00045"></a><span class="lineno"> 45</span>&nbsp;<span class="keyword">class </span>IInstanceProcessor;</div><div class="line"><a name="l00046"></a><span class="lineno"> 46</span>&nbsp;<span class="keyword">class </span>InstanceProfiler;</div><div class="line"><a name="l00047"></a><span class="lineno"> 47</span>&nbsp;<span class="keyword">class </span>IDBChangesMonitor;</div><div class="line"><a name="l00048"></a><span class="lineno"> 48</span>&nbsp;<span class="keyword">class </span><a class="code" href="class_i_database_snapshot.html">IDatabaseSnapshot</a>;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="code" href="class_i_data_base.html"> 58</a></span>&nbsp;<span class="keyword">class </span><a class="code" href="class_i_data_base.html">IDataBase</a></div><div class="line"><a name="l00059"></a><span class="lineno"> 59</span>&nbsp;{</div><div class="line"><a name="l00060"></a><span class="lineno"> 60</span>&nbsp;<span class="keyword">public</span>:</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aff1acdd6cb7794ef2e04d7526e08558f"> 64</a></span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aff1acdd6cb7794ef2e04d7526e08558f">~IDataBase</a>() {};</div><div class="line"><a name="l00065"></a><span class="lineno"> 65</span>&nbsp; </div><div class="line"><a name="l00067"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510"> 67</a></span>&nbsp; <span class="keyword">typedef</span> <span class="keyword">enum</span></div><div class="line"><a name="l00068"></a><span class="lineno"> 68</span>&nbsp; {</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510af21dc0bfcf9ad4b2c3169f53de1f35d4"> 70</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510af21dc0bfcf9ad4b2c3169f53de1f35d4">kNoError</a> = 0,</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510ad361fb4d3d279319c7662e322510f4d3"> 72</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510ad361fb4d3d279319c7662e322510f4d3">kUserCanceled</a>,</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510af842ad75d63bc30775114d8e7013aba3"> 74</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510af842ad75d63bc30775114d8e7013aba3">kUnknownError</a>,</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a3473a5cac5f7a8bb51538f0b4b8c9ca9"> 76</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a3473a5cac5f7a8bb51538f0b4b8c9ca9">kLowMemoryError</a>,</div><div class="line"><a name="l00078"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a78dae7dcb686f98d1b934d506c7d9abb"> 78</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a78dae7dcb686f98d1b934d506c7d9abb">kFileDamagedError</a>, <span class="comment">// file may be recoverable</span></div><div class="line"><a name="l00080"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a3aa86625bb7f34c3dc06d6143e42ed32"> 80</a></span>&nbsp;<span class="comment"></span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a3aa86625bb7f34c3dc06d6143e42ed32">kFileCorruptError</a>, <span class="comment">// file is not recoverable</span></div><div class="line"><a name="l00082"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510adebec6ede2ab6021983b73f069ce092d"> 82</a></span>&nbsp;<span class="comment"></span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510adebec6ede2ab6021983b73f069ce092d">kFileNotFoundError</a>,</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a22d38c6c8aefabf01378053ae9a8b3fa"> 84</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a22d38c6c8aefabf01378053ae9a8b3fa">kFileIsOpenError</a>,</div><div class="line"><a name="l00086"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510ae0483c6cf756a185237df06f5220a78b"> 86</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510ae0483c6cf756a185237df06f5220a78b">kFileIsReadOnlyError</a>,</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510ac5b8d8ce58492973e1c29a39d8c5ad34"> 88</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510ac5b8d8ce58492973e1c29a39d8c5ad34">kDiskFullError</a>,</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510aeabd7b1dfa381ea17f008dfa8139f777"> 90</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510aeabd7b1dfa381ea17f008dfa8139f777">kNotFoundError</a>,</div><div class="line"><a name="l00092"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a307671d7118ffc3cf07460de1e356b99"> 92</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a307671d7118ffc3cf07460de1e356b99">kFileChangedError</a>,</div><div class="line"><a name="l00094"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510aabff161c31d2ce2229b9e80d06503562"> 94</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510aabff161c31d2ce2229b9e80d06503562">kWrongVersionError</a>,</div><div class="line"><a name="l00096"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510aec1abffbdf96338cffff1c375d25cd09"> 96</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510aec1abffbdf96338cffff1c375d25cd09">kFileIsNotOpenError</a>,</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a35ae0a9586608c5390cf15ba1307ed87"> 98</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a35ae0a9586608c5390cf15ba1307ed87">kInvalidFileFormatError</a>,</div><div class="line"><a name="l00100"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a96816b0f49e86f26cddff67c2f3daa96"> 100</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a96816b0f49e86f26cddff67c2f3daa96">kTooManyFilesError</a>,</div><div class="line"><a name="l00102"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a51fb5afe84776396d792cf8f59045d09"> 102</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a51fb5afe84776396d792cf8f59045d09">kOutstandingClonesSaveError</a>,</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a00bee514f0ce44647e249d1df36ba741"> 104</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a00bee514f0ce44647e249d1df36ba741">kOutstandingTransactionsSaveError</a>,</div><div class="line"><a name="l00106"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510adc1a4dd4f8f89f273f2d7384a0c4d785"> 106</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510adc1a4dd4f8f89f273f2d7384a0c4d785">kDBMergeFailed</a>,</div><div class="line"><a name="l00108"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a70af50ba9d6e816df2ceee179f3d7081"> 108</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a70af50ba9d6e816df2ceee179f3d7081">kDBModeSwitchFailed</a>,</div><div class="line"><a name="l00110"></a><span class="lineno"><a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a901b8b93e6fe0c254d0d66cb3ffb9106"> 110</a></span>&nbsp; <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510a901b8b93e6fe0c254d0d66cb3ffb9106">kMiniSaveFileVerificationFailedError</a>, <span class="comment">//temp file damaged due to MiniSave</span></div><div class="line"><a name="l00111"></a><span class="lineno"> 111</span>&nbsp; kUserFileVerificationFailedError <span class="comment">//user file damaged due to merge of tempfile</span></div><div class="line"><a name="l00112"></a><span class="lineno"> 112</span>&nbsp; } <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a>;</div><div class="line"><a name="l00113"></a><span class="lineno"> 113</span>&nbsp; </div><div class="line"><a name="l00114"></a><span class="lineno"> 114</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00115"></a><span class="lineno"> 115</span>&nbsp; <span class="comment">// Objects &amp; UIDS</span></div><div class="line"><a name="l00116"></a><span class="lineno"> 116</span>&nbsp; <span class="comment">//</span></div><div class="line"><a name="l00117"></a><span class="lineno"> 117</span>&nbsp; <span class="comment">// Create, Instantiate and delete objects in the database.</span></div><div class="line"><a name="l00118"></a><span class="lineno"> 118</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00119"></a><span class="lineno"> 119</span>&nbsp; </div><div class="line"><a name="l00125"></a><span class="lineno"> 125</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_d_type.html">UID</a> <a class="code" href="class_i_data_base.html#a7b9090fdc18c31c3e46310c2aa06be5a">NewUID</a>(<a class="code" href="class_i_d_type.html">ClassID</a> clsID) = 0;</div><div class="line"><a name="l00133"></a><span class="lineno"> 133</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#add3849bdb55de533c806467ff75c088a">DeleteUID</a>(<a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>) = 0;</div><div class="line"><a name="l00141"></a><span class="lineno"> 141</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#a331b27871134f21b6a54e2181f4703a2">UndeleteUID</a>(<a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>, <a class="code" href="class_i_d_type.html">ClassID</a> clsID) = 0;</div><div class="line"><a name="l00148"></a><span class="lineno"> 148</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#a0ed904dadda5226ee7399f950bda2b4f">DestroyDeletedUID</a>(<a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>) = 0;</div><div class="line"><a name="l00149"></a><span class="lineno"> 149</span>&nbsp; </div><div class="line"><a name="l00160"></a><span class="lineno"> 160</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_p_m_unknown.html">IPMUnknown</a> *<a class="code" href="class_i_data_base.html#aec63057065182a4dc0f7e0ec591d8175">Instantiate</a>(<a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>, <a class="code" href="class_i_d_type.html">PMIID</a> interfaceID) = 0;</div><div class="line"><a name="l00161"></a><span class="lineno"> 161</span>&nbsp;</div><div class="line"><a name="l00169"></a><span class="lineno"> 169</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_p_m_unknown.html">IPMUnknown</a> *<a class="code" href="class_i_data_base.html#af16d78ba111673a6d7d282f5553011b2">QueryInstance</a>(<a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>, <a class="code" href="class_i_d_type.html">PMIID</a> interfaceID) = 0;</div><div class="line"><a name="l00170"></a><span class="lineno"> 170</span>&nbsp; </div><div class="line"><a name="l00178"></a><span class="lineno"> 178</span>&nbsp; <span class="keyword">virtual</span> bool8 <a class="code" href="class_i_data_base.html#a96e19add638d3e1cdad242e7245e635d">IsValidUID</a>(<a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>) <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00179"></a><span class="lineno"> 179</span>&nbsp; </div><div class="line"><a name="l00184"></a><span class="lineno"> 184</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_d_type.html">UID</a> <a class="code" href="class_i_data_base.html#a7fe2aa8e012510c2dfe26c8427ce5b5a">GetRootUID</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00190"></a><span class="lineno"> 190</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_d_type.html">ClassID</a> <a class="code" href="class_i_data_base.html#a94b756c55f9aa969a9c820e9bb26df45">GetClass</a>(<a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>) <span class="keyword">const</span> = 0; </div><div class="line"><a name="l00191"></a><span class="lineno"> 191</span>&nbsp;</div><div class="line"><a name="l00198"></a><span class="lineno"> 198</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_u_i_d_iterator.html">IUIDIterator</a> *<a class="code" href="class_i_data_base.html#a382d9e8f1477d47a6b9a4b1e469c9354">NewUIDIterator</a>(bool8 includeDeletedUIDs = kFalse) <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00203"></a><span class="lineno"> 203</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#ac09e3ce51057ede9a99e4a709188249e">DeleteUIDIterator</a>(<a class="code" href="class_i_u_i_d_iterator.html">IUIDIterator</a> **iterator) <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00204"></a><span class="lineno"> 204</span>&nbsp; </div><div class="line"><a name="l00206"></a><span class="lineno"> 206</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a1b70cdf8ba54a8836e8f7fa5aaff5530">AssertOnModification</a> () = 0; <span class="comment">// Asserts if the database has been modified used to assert if the database is being dirtied on saveing.</span></div><div class="line"><a name="l00207"></a><span class="lineno"> 207</span>&nbsp; </div><div class="line"><a name="l00208"></a><span class="lineno"> 208</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00209"></a><span class="lineno"> 209</span>&nbsp; <span class="comment">// DataBaseObservers</span></div><div class="line"><a name="l00210"></a><span class="lineno"> 210</span>&nbsp; <span class="comment">//</span></div><div class="line"><a name="l00211"></a><span class="lineno"> 211</span>&nbsp; <span class="comment">// DataBaseObservers are notified for modification actions to UIDs.</span></div><div class="line"><a name="l00212"></a><span class="lineno"> 212</span>&nbsp; <span class="comment">// See IDataBaseObserver.h</span></div><div class="line"><a name="l00213"></a><span class="lineno"> 213</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00214"></a><span class="lineno"> 214</span>&nbsp;</div><div class="line"><a name="l00219"></a><span class="lineno"> 219</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a45cddefd1b0e01bb2c453e6c71d483b0">AttachDataObserver</a>(<a class="code" href="class_i_database_observer.html">IDatabaseObserver</a>* observer) = 0;</div><div class="line"><a name="l00224"></a><span class="lineno"> 224</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#afbcd1e34bb2cca80f3e83977f8de9979">DetachDataObserver</a>(<a class="code" href="class_i_database_observer.html">IDatabaseObserver</a>* observer) = 0;</div><div class="line"><a name="l00225"></a><span class="lineno"> 225</span>&nbsp;</div><div class="line"><a name="l00226"></a><span class="lineno"> 226</span>&nbsp; </div><div class="line"><a name="l00227"></a><span class="lineno"> 227</span>&nbsp; </div><div class="line"><a name="l00228"></a><span class="lineno"> 228</span>&nbsp; <span class="comment">//--------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00229"></a><span class="lineno"> 229</span>&nbsp; <span class="comment">// DataBase File Info</span></div><div class="line"><a name="l00230"></a><span class="lineno"> 230</span>&nbsp; <span class="comment">//-------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00231"></a><span class="lineno"> 231</span>&nbsp; </div><div class="line"><a name="l00233"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a6a7ea5be7b95880d4415e4eb1288ea2e"> 233</a></span>&nbsp; <span class="keyword">typedef</span> <span class="keyword">enum</span></div><div class="line"><a name="l00234"></a><span class="lineno"> 234</span>&nbsp; {</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a6a7ea5be7b95880d4415e4eb1288ea2eaee2b1ea321dbea2da0cb33fab31d3216"> 236</a></span>&nbsp; <a class="code" href="class_i_data_base.html#a6a7ea5be7b95880d4415e4eb1288ea2eaee2b1ea321dbea2da0cb33fab31d3216">kSwapUnknown</a> = 0,</div><div class="line"><a name="l00238"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a6a7ea5be7b95880d4415e4eb1288ea2ea67c13e9b8f5077041b2b9f61958498ec"> 238</a></span>&nbsp; <a class="code" href="class_i_data_base.html#a6a7ea5be7b95880d4415e4eb1288ea2ea67c13e9b8f5077041b2b9f61958498ec">kIntelOrder</a>, </div><div class="line"><a name="l00240"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a6a7ea5be7b95880d4415e4eb1288ea2ea5c87deedc07f4adce1612c0a2f6479c9"> 240</a></span>&nbsp; <a class="code" href="class_i_data_base.html#a6a7ea5be7b95880d4415e4eb1288ea2ea5c87deedc07f4adce1612c0a2f6479c9">kMotorolaOrder</a></div><div class="line"><a name="l00241"></a><span class="lineno"> 241</span>&nbsp; } <a class="code" href="class_i_data_base.html#a6a7ea5be7b95880d4415e4eb1288ea2e">ByteSwapOrder</a>;</div><div class="line"><a name="l00242"></a><span class="lineno"> 242</span>&nbsp; </div><div class="line"><a name="l00246"></a><span class="lineno"> 246</span>&nbsp; <span class="keyword">virtual</span> uint32 <a class="code" href="class_i_data_base.html#ad8df29208b4ad61ba3d3b05e84ab804d">GetSaveCount</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00250"></a><span class="lineno"> 250</span>&nbsp; <span class="keyword">virtual</span> bool16 <a class="code" href="class_i_data_base.html#ac7b7bb37af68e44de17daafd20ce8065">IsReadOnly</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00254"></a><span class="lineno"> 254</span>&nbsp; <span class="keyword">virtual</span> bool16 <a class="code" href="class_i_data_base.html#a498bfdaf8db5a323648ba31bfd17ba2a">IsModified</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00255"></a><span class="lineno"> 255</span>&nbsp; <span class="comment">// Sets the version number of the application that was used</span></div><div class="line"><a name="l00256"></a><span class="lineno"> 256</span>&nbsp; <span class="comment">// to create the database. INTERNAL USE ONLY</span></div><div class="line"><a name="l00257"></a><span class="lineno"> 257</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">IDataBase::DBResultCode</a> SetVersionNumber(<span class="keyword">const</span> int32&amp; majorVersion, <span class="keyword">const</span> int32&amp; minorVersion) = 0;</div><div class="line"><a name="l00263"></a><span class="lineno"> 263</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#ab875076bb09f4a9bd47052f44b2dfcd4">GetVersionNumber</a>(int32 *majorVersion, int32 *minorVersion) <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00267"></a><span class="lineno"> 267</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#a6a7ea5be7b95880d4415e4eb1288ea2e">ByteSwapOrder</a> <a class="code" href="class_i_data_base.html#a4dc45cc7a66600ae9d8f44bb721fa7ff">GetByteSwap</a>() <span class="keyword">const</span> = 0; </div><div class="line"><a name="l00272"></a><span class="lineno"> 272</span>&nbsp; <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="class_i_d_file.html">IDFile</a>* <a class="code" href="class_i_data_base.html#aa0bb1cef90bee550aa97dbc6f7d78777">GetSysFile</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00273"></a><span class="lineno"> 273</span>&nbsp; </div><div class="line"><a name="l00274"></a><span class="lineno"> 274</span>&nbsp; </div><div class="line"><a name="l00275"></a><span class="lineno"> 275</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00276"></a><span class="lineno"> 276</span>&nbsp; <span class="comment">// DataBase File Handling</span></div><div class="line"><a name="l00277"></a><span class="lineno"> 277</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00278"></a><span class="lineno"> 278</span>&nbsp; </div><div class="line"><a name="l00280"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a9dbb56ce3d7e855224035880a8a8599e"> 280</a></span>&nbsp; <span class="keyword">typedef</span> <span class="keyword">enum</span></div><div class="line"><a name="l00281"></a><span class="lineno"> 281</span>&nbsp; {</div><div class="line"><a name="l00283"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a9dbb56ce3d7e855224035880a8a8599ea8765e52dc14c3f2789349ca7346eec41"> 283</a></span>&nbsp; <a class="code" href="class_i_data_base.html#a9dbb56ce3d7e855224035880a8a8599ea8765e52dc14c3f2789349ca7346eec41">kRead</a>,</div><div class="line"><a name="l00285"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a9dbb56ce3d7e855224035880a8a8599ea3a9d23bc4ba5b89f8eedc379b7207f57"> 285</a></span>&nbsp; <a class="code" href="class_i_data_base.html#a9dbb56ce3d7e855224035880a8a8599ea3a9d23bc4ba5b89f8eedc379b7207f57">kWrite</a>,</div><div class="line"><a name="l00288"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a9dbb56ce3d7e855224035880a8a8599eaf0baccc69a42bbe205ff0aa989838c83"> 288</a></span>&nbsp; <a class="code" href="class_i_data_base.html#a9dbb56ce3d7e855224035880a8a8599eaf0baccc69a42bbe205ff0aa989838c83">kCopy</a></div><div class="line"><a name="l00289"></a><span class="lineno"> 289</span>&nbsp; } <a class="code" href="class_i_data_base.html#a9dbb56ce3d7e855224035880a8a8599e">OpenFlags</a>;</div><div class="line"><a name="l00290"></a><span class="lineno"> 290</span>&nbsp; </div><div class="line"><a name="l00292"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a26276d334ab6260b77c52289154f1560"> 292</a></span>&nbsp; <span class="keyword">typedef</span> <span class="keyword">enum</span></div><div class="line"><a name="l00293"></a><span class="lineno"> 293</span>&nbsp; {</div><div class="line"><a name="l00295"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a26276d334ab6260b77c52289154f1560a23dce616bd8058f70a0a5af4a4290deb"> 295</a></span>&nbsp; <a class="code" href="class_i_data_base.html#a26276d334ab6260b77c52289154f1560a23dce616bd8058f70a0a5af4a4290deb">kSaveAs</a>,</div><div class="line"><a name="l00297"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a26276d334ab6260b77c52289154f1560a1ca16c7a70961918884179fd3e863401"> 297</a></span>&nbsp; <a class="code" href="class_i_data_base.html#a26276d334ab6260b77c52289154f1560a1ca16c7a70961918884179fd3e863401">kSaveACopy</a></div><div class="line"><a name="l00298"></a><span class="lineno"> 298</span>&nbsp; } <a class="code" href="class_i_data_base.html#a26276d334ab6260b77c52289154f1560">SaveFlags</a>;</div><div class="line"><a name="l00299"></a><span class="lineno"> 299</span>&nbsp; </div><div class="line"><a name="l00304"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81e"> 304</a></span>&nbsp; <span class="keyword">typedef</span> <span class="keyword">enum</span></div><div class="line"><a name="l00305"></a><span class="lineno"> 305</span>&nbsp; {</div><div class="line"><a name="l00310"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81ea6eb1b6197e3ea6728465ffd813d8d6d6"> 310</a></span>&nbsp; <a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81ea6eb1b6197e3ea6728465ffd813d8d6d6">kDeleteAfterUse</a> = -1,</div><div class="line"><a name="l00316"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81ead4a6f3399529f16e48d3ab0c84cb5800"> 316</a></span>&nbsp; <a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81ead4a6f3399529f16e48d3ab0c84cb5800">kNoProtection</a> = 0, </div><div class="line"><a name="l00322"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81ea39f982995f3fffd34d2fdec6a99c9bc1"> 322</a></span>&nbsp; <a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81ea39f982995f3fffd34d2fdec6a99c9bc1">kProtectSave</a>, </div><div class="line"><a name="l00327"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81eafbec3b9a89b985cab49b60fb9a163341"> 327</a></span>&nbsp; <a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81eafbec3b9a89b985cab49b60fb9a163341">kProtectMiniSave</a></div><div class="line"><a name="l00328"></a><span class="lineno"> 328</span>&nbsp; } <a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81e">ProtectionLevel</a>;</div><div class="line"><a name="l00329"></a><span class="lineno"> 329</span>&nbsp; </div><div class="line"><a name="l00335"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a25222b99a91cba57c85e822eeeca2e5b"> 335</a></span>&nbsp; <span class="keyword">typedef</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> (*<a class="code" href="class_i_data_base.html#a25222b99a91cba57c85e822eeeca2e5b">DBProgressFunction</a>)(int32 stepsDone, int32 stepCount);</div><div class="line"><a name="l00336"></a><span class="lineno"> 336</span>&nbsp;</div><div class="line"><a name="l00341"></a><span class="lineno"> 341</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#a59cbc3a19ff7cbf8c8acff0d69803be9">New</a>(<a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81e">ProtectionLevel</a> protLevel) = 0;</div><div class="line"><a name="l00348"></a><span class="lineno"> 348</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#a03040e64d432923e9f73ab016e80b33e">Open</a>(<span class="keyword">const</span> <a class="code" href="class_i_d_file.html">IDFile</a>&amp; whatFile, <a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81e">ProtectionLevel</a> protLevel,</div><div class="line"><a name="l00349"></a><span class="lineno"> 349</span>&nbsp; <a class="code" href="class_i_data_base.html#a9dbb56ce3d7e855224035880a8a8599e">OpenFlags</a> openFlag = <a class="code" href="class_i_data_base.html#a9dbb56ce3d7e855224035880a8a8599ea3a9d23bc4ba5b89f8eedc379b7207f57">kWrite</a>) = 0;</div><div class="line"><a name="l00354"></a><span class="lineno"> 354</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#a69d77f0feafbd6d4c464765e1a7c29dc">Revert</a>() = 0;</div><div class="line"><a name="l00362"></a><span class="lineno"> 362</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#aa70606b5f5ec6811713fd3052e4d1222">Recover</a>(<span class="keyword">const</span> <a class="code" href="class_i_d_file.html">IDFile</a>* damagedFile, <a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81e">ProtectionLevel</a> protLevel,</div><div class="line"><a name="l00363"></a><span class="lineno"> 363</span>&nbsp; <a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81e">ProtectionLevel</a> oldProtLevel, <span class="keyword">const</span> <a class="code" href="class_i_d_file.html">IDFile</a>* miniSaveFile = nil) = 0;</div><div class="line"><a name="l00364"></a><span class="lineno"> 364</span>&nbsp; </div><div class="line"><a name="l00369"></a><span class="lineno"> 369</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#adda874f2a04541bcec45b07dd0bcb43c">Save</a>() = 0;</div><div class="line"><a name="l00375"></a><span class="lineno"> 375</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#a104d99974fe66c911b91788918e0cee2">SaveAs</a>(<span class="keyword">const</span> <a class="code" href="class_i_d_file.html">IDFile</a>&amp; destFile,</div><div class="line"><a name="l00376"></a><span class="lineno"> 376</span>&nbsp; <a class="code" href="class_i_data_base.html#a26276d334ab6260b77c52289154f1560">SaveFlags</a> saveFlag = <a class="code" href="class_i_data_base.html#a26276d334ab6260b77c52289154f1560a23dce616bd8058f70a0a5af4a4290deb">kSaveAs</a>) = 0;</div><div class="line"><a name="l00377"></a><span class="lineno"> 377</span>&nbsp; </div><div class="line"><a name="l00382"></a><span class="lineno"> 382</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#aee02931256912ce7cea5ae5d23db640f">SetModified</a>(bool16 modified) = 0;</div><div class="line"><a name="l00383"></a><span class="lineno"> 383</span>&nbsp;</div><div class="line"><a name="l00384"></a><span class="lineno"> 384</span>&nbsp;</div><div class="line"><a name="l00391"></a><span class="lineno"><a class="code" href="class_i_data_base_1_1_save_restore_modified_state.html"> 391</a></span>&nbsp; <span class="keyword">class </span><a class="code" href="class_i_data_base_1_1_save_restore_modified_state.html">SaveRestoreModifiedState</a></div><div class="line"><a name="l00392"></a><span class="lineno"> 392</span>&nbsp; {</div><div class="line"><a name="l00393"></a><span class="lineno"> 393</span>&nbsp; <span class="keyword">public</span>:</div><div class="line"><a name="l00394"></a><span class="lineno"> 394</span>&nbsp; <a class="code" href="class_i_data_base_1_1_save_restore_modified_state.html">SaveRestoreModifiedState</a>(<a class="code" href="class_i_data_base.html">IDataBase</a> * db)</div><div class="line"><a name="l00395"></a><span class="lineno"> 395</span>&nbsp; : fDB(db)</div><div class="line"><a name="l00396"></a><span class="lineno"> 396</span>&nbsp; {</div><div class="line"><a name="l00397"></a><span class="lineno"> 397</span>&nbsp; <span class="keywordflow">if</span> (db &amp;&amp; db-&gt;<a class="code" href="class_i_data_base.html#a498bfdaf8db5a323648ba31bfd17ba2a">IsModified</a>())</div><div class="line"><a name="l00398"></a><span class="lineno"> 398</span>&nbsp; fDB = nil; <span class="comment">// If the database is already modified we don&#39;t need to restore</span></div><div class="line"><a name="l00399"></a><span class="lineno"> 399</span>&nbsp; }</div><div class="line"><a name="l00400"></a><span class="lineno"> 400</span>&nbsp;</div><div class="line"><a name="l00401"></a><span class="lineno"> 401</span>&nbsp; ~<a class="code" href="class_i_data_base_1_1_save_restore_modified_state.html">SaveRestoreModifiedState</a>()</div><div class="line"><a name="l00402"></a><span class="lineno"> 402</span>&nbsp; {</div><div class="line"><a name="l00403"></a><span class="lineno"> 403</span>&nbsp; <span class="keywordflow">if</span> (fDB)</div><div class="line"><a name="l00404"></a><span class="lineno"> 404</span>&nbsp; fDB-&gt;<a class="code" href="class_i_data_base.html#aee02931256912ce7cea5ae5d23db640f">SetModified</a>(kFalse);</div><div class="line"><a name="l00405"></a><span class="lineno"> 405</span>&nbsp; }</div><div class="line"><a name="l00406"></a><span class="lineno"> 406</span>&nbsp; <span class="keyword">private</span>:</div><div class="line"><a name="l00407"></a><span class="lineno"> 407</span>&nbsp; <a class="code" href="class_i_data_base.html">IDataBase</a> * fDB;</div><div class="line"><a name="l00408"></a><span class="lineno"> 408</span>&nbsp; };</div><div class="line"><a name="l00409"></a><span class="lineno"> 409</span>&nbsp; </div><div class="line"><a name="l00415"></a><span class="lineno"> 415</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a0b2ebece00fdd0db11bf63d6e2cdaf39">SetPlatformFileInfo</a>(<span class="keywordtype">void</span> *fileInfo) = 0;</div><div class="line"><a name="l00416"></a><span class="lineno"> 416</span>&nbsp;</div><div class="line"><a name="l00420"></a><span class="lineno"> 420</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#a25222b99a91cba57c85e822eeeca2e5b">DBProgressFunction</a> <a class="code" href="class_i_data_base.html#a06b3f9ca664f286662c11c0786361292">SetProgressCallback</a>(<a class="code" href="class_i_data_base.html#a25222b99a91cba57c85e822eeeca2e5b">DBProgressFunction</a> callback) = 0;</div><div class="line"><a name="l00421"></a><span class="lineno"> 421</span>&nbsp; </div><div class="line"><a name="l00422"></a><span class="lineno"> 422</span>&nbsp; </div><div class="line"><a name="l00423"></a><span class="lineno"> 423</span>&nbsp; <span class="comment">//--------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00424"></a><span class="lineno"> 424</span>&nbsp; <span class="comment">// Transactions &amp; Mini-Save</span></div><div class="line"><a name="l00425"></a><span class="lineno"> 425</span>&nbsp; <span class="comment">//</span></div><div class="line"><a name="l00426"></a><span class="lineno"> 426</span>&nbsp; <span class="comment">// All changes to the database must be encapsulated in a transaction.</span></div><div class="line"><a name="l00427"></a><span class="lineno"> 427</span>&nbsp; <span class="comment">// Nested transactions are possible.</span></div><div class="line"><a name="l00428"></a><span class="lineno"> 428</span>&nbsp; <span class="comment">//</span></div><div class="line"><a name="l00429"></a><span class="lineno"> 429</span>&nbsp; <span class="comment">// You usually do not have to call Begin/EndTransaction yourself.</span></div><div class="line"><a name="l00430"></a><span class="lineno"> 430</span>&nbsp; <span class="comment">//</span></div><div class="line"><a name="l00431"></a><span class="lineno"> 431</span>&nbsp; <span class="comment">// An assert regarding a database change outside of a transaction is usually </span></div><div class="line"><a name="l00432"></a><span class="lineno"> 432</span>&nbsp; <span class="comment">// caused by either a modification outside of a command, a command with</span></div><div class="line"><a name="l00433"></a><span class="lineno"> 433</span>&nbsp; <span class="comment">// an incorrect target, or a command that modifies more than one database.</span></div><div class="line"><a name="l00434"></a><span class="lineno"> 434</span>&nbsp; <span class="comment">//--------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00435"></a><span class="lineno"> 435</span>&nbsp; </div><div class="line"><a name="l00447"></a><span class="lineno"> 447</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#abdd51fca6171c7fabed8447faedba55a">BeginTransaction</a>() = 0;</div><div class="line"><a name="l00452"></a><span class="lineno"> 452</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#a9b4b2aa25eded1c7e6692ef719b663ac">EndTransaction</a>() = 0;</div><div class="line"><a name="l00453"></a><span class="lineno"> 453</span>&nbsp;</div><div class="line"><a name="l00457"></a><span class="lineno"> 457</span>&nbsp; <span class="keyword">virtual</span> int32 <a class="code" href="class_i_data_base.html#af4ac7da036bc066c63c2983a69d01822">GetTransactionLevel</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00458"></a><span class="lineno"> 458</span>&nbsp;</div><div class="line"><a name="l00463"></a><span class="lineno"> 463</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#a7c32e77fc00337524a64e92c6160d81e">ProtectionLevel</a> <a class="code" href="class_i_data_base.html#ad8b85367d6ffe62091e8961b0a8ab547">GetProtectionLevel</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00469"></a><span class="lineno"> 469</span>&nbsp; <span class="keyword">virtual</span> uint32 <a class="code" href="class_i_data_base.html#aa97c195eaa262226136167fa84ddabb3">SetMiniSaveInterval</a>(uint32 msecs) = 0;</div><div class="line"><a name="l00473"></a><span class="lineno"> 473</span>&nbsp; <span class="keyword">virtual</span> uint32 <a class="code" href="class_i_data_base.html#add11767b9ac775eb79957a28d76b880c">GetMiniSaveInterval</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00474"></a><span class="lineno"> 474</span>&nbsp; </div><div class="line"><a name="l00478"></a><span class="lineno"> 478</span>&nbsp; <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="class_i_d_file.html">IDFile</a>* <a class="code" href="class_i_data_base.html#af8fc96697ecd8225094ead4c88d2511e">GetMiniSaveFile</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00479"></a><span class="lineno"> 479</span>&nbsp; </div><div class="line"><a name="l00483"></a><span class="lineno"> 483</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#a65432c6bc94c6eeb56e20f446e44c3be">GetErrorCode</a>() = 0;</div><div class="line"><a name="l00486"></a><span class="lineno"> 486</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a86d4a0084d9a34cec17ba49bd6e9174f">ClearError</a>() = 0;</div><div class="line"><a name="l00487"></a><span class="lineno"> 487</span>&nbsp; </div><div class="line"><a name="l00488"></a><span class="lineno"> 488</span>&nbsp; </div><div class="line"><a name="l00489"></a><span class="lineno"> 489</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00490"></a><span class="lineno"> 490</span>&nbsp; <span class="comment">// Contiguous UID Support</span></div><div class="line"><a name="l00491"></a><span class="lineno"> 491</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00492"></a><span class="lineno"> 492</span>&nbsp;</div><div class="line"><a name="l00494"></a><span class="lineno"> 494</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_d_type.html">UID</a> <a class="code" href="class_i_data_base.html#a9801186e8e3ecdd3553290ad3b070048">NewContiguousUID</a> (uint16 type, bool16 externallyWritable) = 0;</div><div class="line"><a name="l00496"></a><span class="lineno"> 496</span>&nbsp; <span class="keyword">virtual</span> bool16 <a class="code" href="class_i_data_base.html#a2de28e708bc501ead2a28c59873d8d98">GetContiguousUIDChangeMarker</a> (<a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>) <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00498"></a><span class="lineno"> 498</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a8977026d5b7421a309578a522c3fbe63">SetContiguousUIDChangeMarker</a> (<a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>, bool16 changed) = 0;</div><div class="line"><a name="l00499"></a><span class="lineno"> 499</span>&nbsp;</div><div class="line"><a name="l00500"></a><span class="lineno"> 500</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00501"></a><span class="lineno"> 501</span>&nbsp; <span class="comment">// For internal use only</span></div><div class="line"><a name="l00502"></a><span class="lineno"> 502</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00503"></a><span class="lineno"> 503</span>&nbsp;</div><div class="line"><a name="l00505"></a><span class="lineno"> 505</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a42e3a1db513c94c36325678529eba6dd">DestructInstance</a>(<a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>) = 0;</div><div class="line"><a name="l00507"></a><span class="lineno"> 507</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#aa9a9009c82fafb6026d3c01f05b5a5eb">ClearDirty</a>(<a class="code" href="class_i_p_m_persist.html">IPMPersist</a> *flushThis) = 0;</div><div class="line"><a name="l00509"></a><span class="lineno"> 509</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#aad7003415ed945c4fb953d88cf4bf311">DirtyObject</a>(<a class="code" href="class_i_p_m_persist.html">IPMPersist</a> *flushThis, <a class="code" href="class_i_d_type.html">ClassID</a> clsID, <a class="code" href="class_i_d_type.html">ImplementationID</a> tag, bool16 allowModification = kTrue, bool16 firstDirtyInterface = kTrue) = 0;</div><div class="line"><a name="l00511"></a><span class="lineno"> 511</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#ac8c3f56fbcb3e9ce3ae0730788041627">SetError</a>(<a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> dbErrCode, <span class="keyword">const</span> <a class="code" href="class_i_d_file.html">IDFile</a>* userProvidedFile = <span class="keyword">nullptr</span>) = 0;</div><div class="line"><a name="l00513"></a><span class="lineno"> 513</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a0a6eb4f96a5184cd5d864625a7be580a">PurgeMemory</a>(int32 level) = 0;</div><div class="line"><a name="l00515"></a><span class="lineno"> 515</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a94b918326a0372bfe185c63524feacdc">AdviseMemoryState</a>(int32 level) = 0;</div><div class="line"><a name="l00517"></a><span class="lineno"> 517</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a64e57e8a588384efcabb3901d7718ff2">RegisterRootObject</a>(<a class="code" href="class_i_p_m_unknown.html">IPMUnknown</a> *root) = 0;</div><div class="line"><a name="l00519"></a><span class="lineno"> 519</span>&nbsp; <span class="keyword">virtual</span> IPubFile* <a class="code" href="class_i_data_base.html#ae02a57666360af3bf9d425cb0913834b">GetPubFile</a>() = 0;</div><div class="line"><a name="l00521"></a><span class="lineno"> 521</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a1674ea3287d4260ef2d007c4936663ca">IterateInstantiatedObjects</a>(IInstanceProcessor *i) = 0;</div><div class="line"><a name="l00523"></a><span class="lineno"> 523</span>&nbsp; <span class="keyword">virtual</span> InstanceProfiler *<a class="code" href="class_i_data_base.html#a06dc4107499a19c06ecb1d487c5c7036">NewInstanceProfiler</a>() = 0;</div><div class="line"><a name="l00524"></a><span class="lineno"> 524</span>&nbsp; </div><div class="line"><a name="l00525"></a><span class="lineno"> 525</span>&nbsp;<span class="preprocessor">#ifdef DEBUG</span></div><div class="line"><a name="l00526"></a><span class="lineno"> 526</span>&nbsp;<span class="preprocessor"></span></div><div class="line"><a name="l00527"></a><span class="lineno"> 527</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetInstanceCacheState(bool16 on) = 0;</div><div class="line"><a name="l00529"></a><span class="lineno"> 529</span>&nbsp; <span class="keyword">virtual</span> bool16 GetInstanceCacheState() = 0;</div><div class="line"><a name="l00530"></a><span class="lineno"> 530</span>&nbsp; </div><div class="line"><a name="l00532"></a><span class="lineno"> 532</span>&nbsp; <span class="keyword">virtual</span> bool16 SetDirtyLimit(bool16 allowModification) = 0;</div><div class="line"><a name="l00534"></a><span class="lineno"> 534</span>&nbsp; <span class="keyword">virtual</span> bool16 GetDirtyLimit() = 0;</div><div class="line"><a name="l00535"></a><span class="lineno"> 535</span>&nbsp; </div><div class="line"><a name="l00537"></a><span class="lineno"> 537</span>&nbsp; <span class="keyword">virtual</span> bool16 BeingDestructed() = 0;</div><div class="line"><a name="l00538"></a><span class="lineno"> 538</span>&nbsp;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00539"></a><span class="lineno"> 539</span>&nbsp;<span class="preprocessor"></span></div><div class="line"><a name="l00540"></a><span class="lineno"> 540</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00541"></a><span class="lineno"> 541</span>&nbsp; <span class="comment">// Date/Time for Underlying Store</span></div><div class="line"><a name="l00542"></a><span class="lineno"> 542</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00543"></a><span class="lineno"> 543</span>&nbsp;</div><div class="line"><a name="l00548"></a><span class="lineno"> 548</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#a556d1adfa48f75209ce5c69af9e4ff3a">GetCreationTime</a> (<a class="code" href="class_i_d_time.html">IDTime</a> &amp;gt) = 0;</div><div class="line"><a name="l00549"></a><span class="lineno"> 549</span>&nbsp;</div><div class="line"><a name="l00554"></a><span class="lineno"> 554</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#aed4be5e9c533a7011e134c0f7d415851">GetModificationTime</a> (<a class="code" href="class_i_d_time.html">IDTime</a> &amp;gt) = 0;</div><div class="line"><a name="l00555"></a><span class="lineno"> 555</span>&nbsp;</div><div class="line"><a name="l00556"></a><span class="lineno"> 556</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00557"></a><span class="lineno"> 557</span>&nbsp; <span class="comment">// Save Sequence Numbers</span></div><div class="line"><a name="l00558"></a><span class="lineno"> 558</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00559"></a><span class="lineno"> 559</span>&nbsp;</div><div class="line"><a name="l00561"></a><span class="lineno"> 561</span>&nbsp; <span class="keyword">virtual</span> uint64 <a class="code" href="class_i_data_base.html#a7361e271810bbaf81eb9986579ad503d">GetSequenceNumberAtOpen</a> () <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00563"></a><span class="lineno"> 563</span>&nbsp; <span class="keyword">virtual</span> uint64 <a class="code" href="class_i_data_base.html#a235678d4e569b5b873b415709ed36eca">GetCurrentSequenceNumber</a> () <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00564"></a><span class="lineno"> 564</span>&nbsp;</div><div class="line"><a name="l00566"></a><span class="lineno"><a class="code" href="class_i_data_base.html#ae6dfd753b2f6aaaf2a57bfc27d0ca7f4"> 566</a></span>&nbsp; <span class="keyword">typedef</span> <span class="keyword">enum</span></div><div class="line"><a name="l00567"></a><span class="lineno"> 567</span>&nbsp; {</div><div class="line"><a name="l00568"></a><span class="lineno"> 568</span>&nbsp; kUserFileExclusive = 0,</div><div class="line"><a name="l00569"></a><span class="lineno"> 569</span>&nbsp; kUserFileShared</div><div class="line"><a name="l00570"></a><span class="lineno"> 570</span>&nbsp; } <a class="code" href="class_i_data_base.html#ae6dfd753b2f6aaaf2a57bfc27d0ca7f4">UserFileMode</a>;</div><div class="line"><a name="l00571"></a><span class="lineno"> 571</span>&nbsp;</div><div class="line"><a name="l00572"></a><span class="lineno"> 572</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00573"></a><span class="lineno"> 573</span>&nbsp; <span class="comment">// Cache performance. This API is for internal use only.</span></div><div class="line"><a name="l00574"></a><span class="lineno"> 574</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00576"></a><span class="lineno"> 576</span>&nbsp;<span class="comment"></span> <span class="keyword">virtual</span> uint32 <a class="code" href="class_i_data_base.html#af747f2b0c3830544129c1dcc50c08469">GetCacheFaultRate</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00578"></a><span class="lineno"> 578</span>&nbsp; <span class="keyword">virtual</span> uint32 <a class="code" href="class_i_data_base.html#aa695f0bf3193b70a187250f9d557ec13">GetCacheTotalFaults</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00579"></a><span class="lineno"> 579</span>&nbsp;</div><div class="line"><a name="l00581"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a9ae730422059fc92137c152bcf6e5199"> 581</a></span>&nbsp; <span class="keyword">enum</span> <a class="code" href="class_i_data_base.html#a9ae730422059fc92137c152bcf6e5199">CachePolicy</a></div><div class="line"><a name="l00582"></a><span class="lineno"> 582</span>&nbsp; {</div><div class="line"><a name="l00583"></a><span class="lineno"> 583</span>&nbsp; kAnnaCachePolicy,</div><div class="line"><a name="l00584"></a><span class="lineno"> 584</span>&nbsp; kFaultRateBasedPolicy,</div><div class="line"><a name="l00585"></a><span class="lineno"> 585</span>&nbsp; kCacheAllPolicy</div><div class="line"><a name="l00586"></a><span class="lineno"> 586</span>&nbsp; };</div><div class="line"><a name="l00587"></a><span class="lineno"> 587</span>&nbsp;</div><div class="line"><a name="l00589"></a><span class="lineno"> 589</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#a9ae730422059fc92137c152bcf6e5199">CachePolicy</a> <a class="code" href="class_i_data_base.html#a19ffa5e2667c3b4b4545c6f0692810f3">GetCachePolicy</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00591"></a><span class="lineno"> 591</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a5460dc3fa0d722a638e3760f45a034ee">SetCachePolicy</a>(<a class="code" href="class_i_data_base.html#a9ae730422059fc92137c152bcf6e5199">CachePolicy</a> policy) = 0;</div><div class="line"><a name="l00592"></a><span class="lineno"> 592</span>&nbsp; </div><div class="line"><a name="l00593"></a><span class="lineno"> 593</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00594"></a><span class="lineno"> 594</span>&nbsp; <span class="comment">// Support for better error handling</span></div><div class="line"><a name="l00595"></a><span class="lineno"> 595</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00596"></a><span class="lineno"> 596</span>&nbsp;</div><div class="line"><a name="l00597"></a><span class="lineno"> 597</span>&nbsp;</div><div class="line"><a name="l00603"></a><span class="lineno"> 603</span>&nbsp; <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="class_i_d_file.html">IDFile</a>* <a class="code" href="class_i_data_base.html#a307b64264294720e4dd543c98441b5c9">GetSysFileFromOpen</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00604"></a><span class="lineno"> 604</span>&nbsp;</div><div class="line"><a name="l00605"></a><span class="lineno"> 605</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00606"></a><span class="lineno"> 606</span>&nbsp; <span class="comment">// Snapshot Database Handler</span></div><div class="line"><a name="l00607"></a><span class="lineno"> 607</span>&nbsp; <span class="comment">// Used for tracking changes to UIDs for automatic undo redo of commands. </span></div><div class="line"><a name="l00608"></a><span class="lineno"> 608</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00609"></a><span class="lineno"> 609</span>&nbsp;</div><div class="line"><a name="l00622"></a><span class="lineno"><a class="code" href="class_i_data_base.html#a97bca0ad8b494d4c26709cc8c4a0b662"> 622</a></span>&nbsp; <span class="keyword">typedef</span> <span class="keyword">enum</span> {kNoUndoSupport, kFullUndoSupport, kPartialUndoSupport} <a class="code" href="class_i_data_base.html#a97bca0ad8b494d4c26709cc8c4a0b662">UndoSupport</a>;</div><div class="line"><a name="l00623"></a><span class="lineno"> 623</span>&nbsp;</div><div class="line"><a name="l00626"></a><span class="lineno"> 626</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#a97bca0ad8b494d4c26709cc8c4a0b662">UndoSupport</a> <a class="code" href="class_i_data_base.html#a6ac7a102b384a17db7167898ce840654">GetUndoSupport</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00627"></a><span class="lineno"> 627</span>&nbsp; </div><div class="line"><a name="l00629"></a><span class="lineno"> 629</span>&nbsp; <span class="keyword">virtual</span> IDBChangesMonitor* <a class="code" href="class_i_data_base.html#a8adc405da02368284b9dd3dd12144ace">GetDBChangesMonitor</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00630"></a><span class="lineno"> 630</span>&nbsp;</div><div class="line"><a name="l00632"></a><span class="lineno"> 632</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_database_snapshot.html">IDatabaseSnapshot</a>* <a class="code" href="class_i_data_base.html#a9f69f47ac10eef4f683655bab8b07a81">GetLastDBSnapshotBeforePubFileSharing</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00633"></a><span class="lineno"> 633</span>&nbsp;</div><div class="line"><a name="l00636"></a><span class="lineno"> 636</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a1fc5a1b37601a450190706c3075f6fdb">SetDBChangesMonitor</a>(IDBChangesMonitor* dbChangesMonitor, <a class="code" href="class_i_data_base.html#a97bca0ad8b494d4c26709cc8c4a0b662">UndoSupport</a> undoSupport) = 0;</div><div class="line"><a name="l00637"></a><span class="lineno"> 637</span>&nbsp;</div><div class="line"><a name="l00638"></a><span class="lineno"> 638</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00639"></a><span class="lineno"> 639</span>&nbsp; <span class="comment">// Support for documents which are not datbases</span></div><div class="line"><a name="l00640"></a><span class="lineno"> 640</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00641"></a><span class="lineno"> 641</span>&nbsp; <span class="comment">// InCopy stores documents as XML and merely uses the database as a scratch work file.</span></div><div class="line"><a name="l00642"></a><span class="lineno"> 642</span>&nbsp; <span class="comment">// As a result, assumptions about the user pubfile are invalid. The &quot;faux&quot; user file</span></div><div class="line"><a name="l00643"></a><span class="lineno"> 643</span>&nbsp; <span class="comment">// is our way of informing the database of this situation so as to prevent problems</span></div><div class="line"><a name="l00644"></a><span class="lineno"> 644</span>&nbsp; <span class="comment">// with scripting, the UI and recovery.</span></div><div class="line"><a name="l00646"></a><span class="lineno"> 646</span>&nbsp;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#a7563210671875e658a06713212db4f34">SetFauxUserFile</a>(<span class="keyword">const</span> <a class="code" href="class_i_d_file.html">IDFile</a> &amp;newFile) = 0;</div><div class="line"><a name="l00648"></a><span class="lineno"> 648</span>&nbsp; <span class="keyword">virtual</span> bool16 <a class="code" href="class_i_data_base.html#a1de62dbce81572600f7a03a9a911bf87">IsFauxUserFile</a>() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00649"></a><span class="lineno"> 649</span>&nbsp;</div><div class="line"><a name="l00650"></a><span class="lineno"> 650</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00651"></a><span class="lineno"> 651</span>&nbsp; <span class="comment">// More UID functions. Move up with rest between builds; but don&#39;t change vtable now [][]</span></div><div class="line"><a name="l00652"></a><span class="lineno"> 652</span>&nbsp; <span class="comment">//------------------------------------------------------------------------------------</span></div><div class="line"><a name="l00653"></a><span class="lineno"> 653</span>&nbsp; <span class="comment">// Creates a new persistent object in the database. The caller specifies the desired</span></div><div class="line"><a name="l00654"></a><span class="lineno"> 654</span>&nbsp; <span class="comment">// UID of the new object. This will succeed under the following conditions:</span></div><div class="line"><a name="l00655"></a><span class="lineno"> 655</span>&nbsp; <span class="comment">// 1. The requested UID is in the valid range - (currently: 1 &lt;= UID &lt;= 2^31-1)</span></div><div class="line"><a name="l00656"></a><span class="lineno"> 656</span>&nbsp; <span class="comment">// 2. The UID has either never been used, or can be re-used</span></div><div class="line"><a name="l00657"></a><span class="lineno"> 657</span>&nbsp; <span class="comment">// A UID that was used before can only be re-used provided that it does not exist</span></div><div class="line"><a name="l00658"></a><span class="lineno"> 658</span>&nbsp; <span class="comment">// in either the temporary file or the user file. This requires at least calling</span></div><div class="line"><a name="l00659"></a><span class="lineno"> 659</span>&nbsp; <span class="comment">// DeleteUID and DestoryUID, and performing a save operation afterwards if the</span></div><div class="line"><a name="l00660"></a><span class="lineno"> 660</span>&nbsp; <span class="comment">// database protection level is greater than kNoProtection.</span></div><div class="line"><a name="l00661"></a><span class="lineno"> 661</span>&nbsp; <span class="comment">//</span></div><div class="line"><a name="l00662"></a><span class="lineno"> 662</span>&nbsp; <span class="comment">// There may be three outcomes when calling this function. Callers should be prepared:</span></div><div class="line"><a name="l00663"></a><span class="lineno"> 663</span>&nbsp; <span class="comment">//</span></div><div class="line"><a name="l00664"></a><span class="lineno"> 664</span>&nbsp; <span class="comment">// If the function succeeds, the object is created and the function returns kTrue</span></div><div class="line"><a name="l00665"></a><span class="lineno"> 665</span>&nbsp; <span class="comment">// </span></div><div class="line"><a name="l00666"></a><span class="lineno"> 666</span>&nbsp; <span class="comment">// If the function fails because the UID isn&#39;t available to be used (outside of the</span></div><div class="line"><a name="l00667"></a><span class="lineno"> 667</span>&nbsp; <span class="comment">// valid range, not available for re-use yet), the function returns kFalse but the</span></div><div class="line"><a name="l00668"></a><span class="lineno"> 668</span>&nbsp; <span class="comment">// database error state is not set</span></div><div class="line"><a name="l00669"></a><span class="lineno"> 669</span>&nbsp; <span class="comment">//</span></div><div class="line"><a name="l00670"></a><span class="lineno"> 670</span>&nbsp; <span class="comment">// If the function fails for some more insidious reason, it returns kFalse and the </span></div><div class="line"><a name="l00671"></a><span class="lineno"> 671</span>&nbsp; <span class="comment">// database error state is set appropriately</span></div><div class="line"><a name="l00673"></a><span class="lineno"> 673</span>&nbsp;<span class="comment"></span> <span class="keyword">virtual</span> bool16 <a class="code" href="class_i_data_base.html#a8d945b46ae1e713b6df8d29acaab1fd2">PlacementNewUID</a>(<a class="code" href="class_i_d_type.html">ClassID</a> clsID, <a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>) = 0;</div><div class="line"><a name="l00674"></a><span class="lineno"> 674</span>&nbsp;</div><div class="line"><a name="l00675"></a><span class="lineno"> 675</span>&nbsp; <span class="comment">// Returns kTrue if the passed UID is valid for use/re-use with PlacementNewUID()</span></div><div class="line"><a name="l00677"></a><span class="lineno"> 677</span>&nbsp;<span class="comment"></span> <span class="keyword">virtual</span> bool16 <a class="code" href="class_i_data_base.html#afee5d82bcb9091c06e3e94543c3a0b1a">PlacementUIDIsAvailable</a> (<a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>) = 0;</div><div class="line"><a name="l00678"></a><span class="lineno"> 678</span>&nbsp;</div><div class="line"><a name="l00679"></a><span class="lineno"> 679</span>&nbsp; <span class="comment">// Flush dirty objects for RIDX query</span></div><div class="line"><a name="l00681"></a><span class="lineno"> 681</span>&nbsp;<span class="comment"></span> <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#ae241f2d89684da6b856c903f2a63203c">FlushDirtyObjectsForRIDXQuery</a> () = 0;</div><div class="line"><a name="l00682"></a><span class="lineno"> 682</span>&nbsp;</div><div class="line"><a name="l00683"></a><span class="lineno"> 683</span>&nbsp; <span class="comment">// Clone the database</span></div><div class="line"><a name="l00684"></a><span class="lineno"> 684</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html">IDataBase</a>* Clone() = 0;</div><div class="line"><a name="l00685"></a><span class="lineno"> 685</span>&nbsp;</div><div class="line"><a name="l00686"></a><span class="lineno"> 686</span>&nbsp; <span class="comment">// Clone a database snapshot (for internal use only)</span></div><div class="line"><a name="l00687"></a><span class="lineno"> 687</span>&nbsp; <span class="keyword">virtual</span> DatabaseSnapshotPtr CloneADatabaseSnapshot() = 0;</div><div class="line"><a name="l00688"></a><span class="lineno"> 688</span>&nbsp;</div><div class="line"><a name="l00689"></a><span class="lineno"> 689</span>&nbsp; <span class="comment">// Call this function after an execution context switch took place (call from child task).</span></div><div class="line"><a name="l00690"></a><span class="lineno"> 690</span>&nbsp; <span class="comment">// Necessary regardless whether the datase has been created as a clone.</span></div><div class="line"><a name="l00691"></a><span class="lineno"> 691</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">bool</span> SwitchExecutionContext() = 0;</div><div class="line"><a name="l00692"></a><span class="lineno"> 692</span>&nbsp; <span class="comment">// Call this function before an execution context switch(call from the the parent task).</span></div><div class="line"><a name="l00693"></a><span class="lineno"> 693</span>&nbsp; <span class="comment">// Not necessary if the datase has just been created as a clone</span></div><div class="line"><a name="l00694"></a><span class="lineno"> 694</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">bool</span> PrepareForExecutionContextSwitch() = 0;</div><div class="line"><a name="l00695"></a><span class="lineno"> 695</span>&nbsp;</div><div class="line"><a name="l00696"></a><span class="lineno"> 696</span>&nbsp; <span class="comment">// clone must be a clone if this</span></div><div class="line"><a name="l00697"></a><span class="lineno"> 697</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> Merge(<a class="code" href="class_i_data_base.html">IDataBase</a> *clone) = 0;</div><div class="line"><a name="l00698"></a><span class="lineno"> 698</span>&nbsp;</div><div class="line"><a name="l00700"></a><span class="lineno"> 700</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> <a class="code" href="class_i_data_base.html#aaab6b412cff614b62cc145fc4f6b175f">DestroyDeletedUID_AfterLastReferenceIsReleased</a>(<a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>) = 0;</div><div class="line"><a name="l00701"></a><span class="lineno"> 701</span>&nbsp;</div><div class="line"><a name="l00703"></a><span class="lineno"> 703</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="class_i_data_base.html#ad5e087a58344493eef64654b3f486f17">AllowPurge</a>() = 0;</div><div class="line"><a name="l00704"></a><span class="lineno"> 704</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> DisallowPurge() = 0;</div><div class="line"><a name="l00705"></a><span class="lineno"> 705</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">void</span> DoScheduledPurge() = 0;</div><div class="line"><a name="l00706"></a><span class="lineno"> 706</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">bool</span> IsPurgeAllowed() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00707"></a><span class="lineno"> 707</span>&nbsp; </div><div class="line"><a name="l00708"></a><span class="lineno"> 708</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_data_base.html#aeb5462fe60d1a1f2f36bd014a0514510">DBResultCode</a> AttemptMiniSave() = 0;</div><div class="line"><a name="l00709"></a><span class="lineno"> 709</span>&nbsp; <span class="keyword">virtual</span> <span class="keywordtype">bool</span> PubFileIsShared() <span class="keyword">const</span> = 0;</div><div class="line"><a name="l00710"></a><span class="lineno"> 710</span>&nbsp; </div><div class="line"><a name="l00711"></a><span class="lineno"> 711</span>&nbsp; <span class="comment">/* You can override what Instantiate() does by setting an override function. Use nil to remove a function.</span></div><div class="line"><a name="l00712"></a><span class="lineno"> 712</span>&nbsp;<span class="comment"> SetInstantiateFunction returns the function that was previously being used, in case client code needs to</span></div><div class="line"><a name="l00713"></a><span class="lineno"> 713</span>&nbsp;<span class="comment"> restore it later.</span></div><div class="line"><a name="l00714"></a><span class="lineno"> 714</span>&nbsp;<span class="comment"> */</span></div><div class="line"><a name="l00715"></a><span class="lineno"><a class="code" href="struct_i_data_base_1_1_instantiate_function_obj.html"> 715</a></span>&nbsp; <span class="keyword">struct </span><a class="code" href="struct_i_data_base_1_1_instantiate_function_obj.html">InstantiateFunctionObj</a></div><div class="line"><a name="l00716"></a><span class="lineno"> 716</span>&nbsp; {</div><div class="line"><a name="l00717"></a><span class="lineno"> 717</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="class_i_p_m_unknown.html">IPMUnknown</a>* operator () (<a class="code" href="class_i_data_base.html">IDataBase</a> *db, <a class="code" href="class_i_d_type.html">UID</a> <span class="keywordtype">id</span>, <a class="code" href="class_i_d_type.html">PMIID</a> faceID) = 0;</div><div class="line"><a name="l00718"></a><span class="lineno"> 718</span>&nbsp; };</div><div class="line"><a name="l00719"></a><span class="lineno"> 719</span>&nbsp;</div><div class="line"><a name="l00720"></a><span class="lineno"> 720</span>&nbsp; <span class="keyword">typedef</span> <a class="code" href="struct_i_data_base_1_1_instantiate_function_obj.html">InstantiateFunctionObj</a>* <a class="code" href="struct_i_data_base_1_1_instantiate_function_obj.html">InstantiateFunction</a>;</div><div class="line"><a name="l00721"></a><span class="lineno"> 721</span>&nbsp;</div><div class="line"><a name="l00722"></a><span class="lineno"> 722</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="struct_i_data_base_1_1_instantiate_function_obj.html">InstantiateFunction</a> SetInstantiateFunction(<a class="code" href="struct_i_data_base_1_1_instantiate_function_obj.html">InstantiateFunction</a> overrideInstantiate = nil) = 0;</div><div class="line"><a name="l00723"></a><span class="lineno"> 723</span>&nbsp; <span class="keyword">virtual</span> <a class="code" href="struct_i_data_base_1_1_instantiate_function_obj.html">InstantiateFunction</a> GetInstantiateFunction() <span class="keyword">const</span> = 0 ;</div><div class="line"><a name="l00724"></a><span class="lineno"> 724</span>&nbsp;</div><div class="line"><a name="l00725"></a><span class="lineno"> 725</span>&nbsp; <span class="comment">/* FileRecoveryMode - for internal use only */</span></div><div class="line"><a name="l00726"></a><span class="lineno"> 726</span>&nbsp; <span class="keyword">typedef</span> <span class="keyword">enum</span> {</div><div class="line"><a name="l00727"></a><span class="lineno"> 727</span>&nbsp; kNoRecovery,</div><div class="line"><a name="l00728"></a><span class="lineno"> 728</span>&nbsp; <span class="comment">/* File opened using Pre trans master page */</span></div><div class="line"><a name="l00729"></a><span class="lineno"> 729</span>&nbsp; kUsingPreTransMasterPage,</div><div class="line"><a name="l00730"></a><span class="lineno"> 730</span>&nbsp; <span class="comment">/*File opened using LPM CoWP page*/</span></div><div class="line"><a name="l00731"></a><span class="lineno"> 731</span>&nbsp; kUsingLPMCoWorkerPage</div><div class="line"><a name="l00732"></a><span class="lineno"> 732</span>&nbsp; } FileRecoveryMode;</div><div class="line"><a name="l00733"></a><span class="lineno"> 733</span>&nbsp;};</div><div class="line"><a name="l00734"></a><span class="lineno"> 734</span>&nbsp;</div><div class="line"><a name="l00735"></a><span class="lineno"> 735</span>&nbsp;</div><div class="line"><a name="l00740"></a><span class="lineno"> 740</span>&nbsp;<span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;</div><div class="line"><a name="l00741"></a><span class="lineno"><a class="code" href="class_d_b_purge_lock.html"> 741</a></span>&nbsp;<span class="keyword">class </span><a class="code" href="class_d_b_purge_lock.html">DBPurgeLock</a></div><div class="line"><a name="l00742"></a><span class="lineno"> 742</span>&nbsp;{</div><div class="line"><a name="l00743"></a><span class="lineno"> 743</span>&nbsp;<span class="keyword">public</span>:</div><div class="line"><a name="l00744"></a><span class="lineno"> 744</span>&nbsp; <a class="code" href="class_d_b_purge_lock.html">DBPurgeLock</a>(T *handler) :</div><div class="line"><a name="l00745"></a><span class="lineno"> 745</span>&nbsp; fHandler(handler)</div><div class="line"><a name="l00746"></a><span class="lineno"> 746</span>&nbsp; {</div><div class="line"><a name="l00747"></a><span class="lineno"> 747</span>&nbsp; fHandler-&gt;AllowPurge();</div><div class="line"><a name="l00748"></a><span class="lineno"> 748</span>&nbsp; }</div><div class="line"><a name="l00749"></a><span class="lineno"> 749</span>&nbsp; ~<a class="code" href="class_d_b_purge_lock.html">DBPurgeLock</a>()</div><div class="line"><a name="l00750"></a><span class="lineno"> 750</span>&nbsp; {</div><div class="line"><a name="l00751"></a><span class="lineno"> 751</span>&nbsp; fHandler-&gt;DisallowPurge();</div><div class="line"><a name="l00752"></a><span class="lineno"> 752</span>&nbsp; fHandler-&gt;DoScheduledPurge();</div><div class="line"><a name="l00753"></a><span class="lineno"> 753</span>&nbsp; }</div><div class="line"><a name="l00754"></a><span class="lineno"> 754</span>&nbsp;<span class="keyword">private</span>:</div><div class="line"><a name="l00755"></a><span class="lineno"> 755</span>&nbsp; T *fHandler;</div><div class="line"><a name="l00756"></a><span class="lineno"> 756</span>&nbsp;};</div><div class="line"><a name="l00757"></a><span class="lineno"> 757</span>&nbsp;</div><div class="line"><a name="l00758"></a><span class="lineno"> 758</span>&nbsp;<span class="comment">// define adobe::type_info&lt;IDatabase&gt; specialization so any_regular_t can move IDataBase across DLL boundaries</span></div><div class="line"><a name="l00759"></a><span class="lineno"> 759</span>&nbsp;ADOBE_NAME_TYPE_0(<span class="stringliteral">&quot;idatabase:indesign:adobe&quot;</span>, <a class="code" href="class_i_data_base.html">IDataBase</a>)</div><div class="line"><a name="l00760"></a><span class="lineno"> 760</span>&nbsp;</div><div class="line"><a name="l00761"></a><span class="lineno"> 761</span>&nbsp;<span class="preprocessor">#endif // __IDATABASE__</span></div></div></div></div><div class="navpath" id="nav-path"><ul><li class="navelem"><a class="el" href="dir_b414fb41bdfd52f0e92898d4ee097632.html">tmpdoxygeninput</a><li class="navelem"><b>IDataBase.h</b><li class="footer">Generated on Wed Nov 11 2020 04:49:44 for InDesign SDK by <a href="http://www.doxygen.org/index.html"> <img alt="doxygen" class="footer" src="doxygen.png" /></a> 1.8.3.1 </ul></div></body></html>
